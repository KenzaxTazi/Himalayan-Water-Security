# Notes for supervision

## 25th June 2020

### MRes report and PhD proposal

* [Report outline](https://www.dropbox.com/s/ufaf2761jwlvgex/MRes%20Report%20Outline.docx?dl=0)
* Outcomes from OECD meeting:
  * The OECD is speaking to the organisations who would use my model outputs.
  * Get in touch with discussed regional/national organisations for more specific input.
  * How should I be presenting my work? Confusion as to whether I am climate or weather forecasting.
  * Maybe a talk at the end of the year.

### Clusters predictions

The correlation between precipitation locations is extremely high within the clusters generated by the soft k-means (see plots below). This is problematic because the model can quite happily assign the same regression outputs for valiation and testing as a neighboring training points, rather than predicting from the other features.

#### Detrended precipitation correlation

![image](https://dl.dropboxusercontent.com/s/23zilc6npm5wdo7/Screenshot%202020-06-25%20at%2009.55.06.png?dl=0)
![image](https://dl.dropboxusercontent.com/s/ou3q6zg2iklimgz/Screenshot%202020-06-25%20at%2009.55.24.png?dl=0)
![image](https://dl.dropboxusercontent.com/s/l30ehrol961wtr7/Screenshot%202020-06-25%20at%2009.55.45.png?dl=0)

Despite this, I proceed with a straingforward adaption of the set separation.

* the last chronogical 10% of each vector for a given location removed.
* the remainded of each location vector is folded 5 times.
* the sets from each location vector are concatenated.

The result below are for the averaged ERA5 data (large scale averaged temperature, no NAO or Nino 4 indices)

|               | Training R2 | Training MSE | Validation R2 | Validation MSE | Predicted TP mean | Predicted TP std |
| ------------- | ----------- | ------------- | ------------- | --------------- | ----------------- | ---------------- |
| Khyber | ? | ? | ? | ? | ? | ? |
| Gilgit | ? | ? | ? | ? | ? | ? |
| Ngari  | ? | ? | ? | ? | ? | ? |

### Ensemble Training

The ERA5 Ensemble Data Assimilation (EDA) consists of an ensemble of ten independent lower-resolution 4D-Var assimilations that differ by perturbing observations, sea surface temperature fields and model physics.

New function to train and apply a GP ensemble to the training data which returns the mean of predicted precipiation values for each point and the mean of the standard deviations.

### Averaged Large Scale 2m Temperature

The following table details the output of GP models with the averaged large scale 2m temperature for Gilgit (35.8884째N, 74.4584째E, 1500m). The validation results are in general _worse_ than without the averaged temperature.

|               | Training R2 | Training MSE | Validation R2 | Validation MSE | Predicted TP mean | Predicted TP std |
| ------------- | ----------- | ------------- | ------------- | --------------- | ----------------- | ---------------- |
| Averaged data | 0.862 | 0.258 | 0.432 | 0.952 | _3.031_ | 0.880 |
| Run 0         | 0.866 | 0.183 | 0.449 | 0.704 | 2.199 | 0.671 |
| Run 1         | 0.867 | 0.174 | 0.510 | _0.613_ | 2.201 | 0.610 |
| Run 2         | 0.865 | 0.181 | 0.389 | 0.742 | 2.153 | 1.546 |
| Run 3         | 0.866 | 0.175 | 0.476 | 0.680 | 2.201 | 0.629 |
| Run 4         | 0.865 | 0.174 | 0.427 | 0.672 | 2.184 | 0.630 |
| Run 5         | 0.801 | 0.262 | _-0.517_ | _1.965_ | 2.310 | _1.855_ |
| Run 6         | 0.880 | 0.155 | _0.477_ | 0.679 | 2.186 | 0.615 |
| Run 7         | 0.865 | 0.168 | _0.477_ | 0.626 | 2.179 | 0.622 |
| Run 8         | 0.874 | 0.167 | 0.450 | 0.720 | 2.172 | _0.541_ |
| Run 9         | 0.865 | 0.183 | 0.426 | 0.683 | 2.202 | 0.687 |
| Ensemble w/ no weighting | 0.254 | 1.392 | -0.253 | 2.101 | 2.199 | 0.841 |

Further investgation is needed as to why the ensemble predictions are so poor. Weigthing is perhaps an issue, I also need to check if the k folding is consistent and I'm not averaging together the wrong data.

### Monthly CGTI

Di Capua et al. show a causal corralation between the Monsoon Through (MT) and the CircumGlobal Teleconection Index (CGTI). The CGTI is defined as the weekly mean geopotential height at 200hPa (Z200) over the region 35-40째N, 60-70째E. For the following results, the index is avarged to a monthly scale.

The averaged ERA5 data is completely constant over this area. I was going to apply an EOF to this field, but I am not sure that would be useful with the data in this state.

Most atmospheric oscillations seem to lag by a week or two, so perhaps we are dampening any signal. However the fact that the field averages to the same value over 40 years is very suspicious and should be investigated.

### Possible next steps

* Generate and include EOFs
* Run GPs for clusters
* Check code for ensemble training with soft voting